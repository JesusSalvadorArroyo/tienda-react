{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\tienda-react\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\tienda-react\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\tienda-react\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\tienda-react\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\tienda-react\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\tienda-react\\\\src\\\\Views\\\\CartShopPage.js\";\nimport React, { Component } from 'react';\nimport TopBar from './TopBar';\nimport { db, firebase } from '../Firebase';\nimport CartList from '../Cart/List.js';\nimport './mainStyle.css';\n\nvar CartShopPage =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(CartShopPage, _Component);\n\n  function CartShopPage(props) {\n    var _this;\n\n    _classCallCheck(this, CartShopPage);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(CartShopPage).call(this, props));\n\n    _this.handlePay = function () {\n      var history = _this.props.history;\n      db.getProductsInCart(_this.state.user.uid).remove().then(function () {\n        return history.push('/');\n      });\n    };\n\n    _this.handleCancel = function () {\n      var history = _this.props.history;\n\n      var item = _this.state.itemsInCart.map(function (item, key) {\n        return item;\n      });\n\n      var disponible = parseInt(item[0].product.disponible, 10);\n      var cantidad = parseInt(item[0].cantidad, 10);\n      item[0].product.disponible = disponible + cantidad;\n      db.getProduct(item[0].id).update(item[0].product);\n      db.getProductsInCart(_this.state.user.uid).remove().then(function () {\n        return history.push('/');\n      });\n    };\n\n    document.title = 'Tienda Online';\n    _this.state = {\n      user: null,\n      itemsInCart: [],\n      total: 0\n    };\n    return _this;\n  } //--------------------------------------------------------------------//\n\n\n  _createClass(CartShopPage, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      document.body.style.backgroundImage = \"url('./img/main-fondo.jpg')\";\n      document.body.style.backgroundRepeat = \"no-repeat\";\n      document.body.style.backgroundSize = \"cover\";\n    } //--------------------------------------------------------------------//\n\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var history = this.props.history;\n      firebase.auth.onAuthStateChanged(function (authUser) {\n        if (authUser) {\n          _this2.setState({\n            user: authUser\n          });\n\n          db.getProductsInCart(authUser.uid).on('value', function (snapshot) {\n            if (snapshot.val()) {\n              _this2.setState({\n                itemsInCart: snapshot.val()\n              });\n            } else _this2.setState({\n              itemsInCart: []\n            });\n          });\n        } else history.push('/login');\n      });\n    } //-------------------------------------------------------------------------//\n\n  }, {\n    key: \"shouldComponentUpdate\",\n    value: function shouldComponentUpdate(nexProps, nextState) {\n      var total = 0;\n      nextState.itemsInCart.map(function (item, index) {\n        return total += item.product.precio * item.cantidad;\n      });\n      nextState.total = total;\n      return true;\n    } //-------------------------------------------------------------------------//\n\n  }, {\n    key: \"render\",\n    //---------------------------------------------------------------------------//\n    value: function render() {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 66\n        },\n        __self: this\n      }, React.createElement(TopBar, {\n        itemsInCart: this.state.itemsInCart,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 67\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"container grey lighten-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 68\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 69\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col s8\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70\n        },\n        __self: this\n      }, React.createElement(\"h3\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71\n        },\n        __self: this\n      }, \" Carrito de compras \")), React.createElement(\"div\", {\n        className: \"col s7\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 73\n        },\n        __self: this\n      }, React.createElement(CartList, {\n        products: this.state.itemsInCart,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"col s5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 76\n        },\n        __self: this\n      }, React.createElement(\"h4\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77\n        },\n        __self: this\n      }, \" Total: $\", this.state.total.toFixed(2)), React.createElement(\"div\", {\n        className: \"buttonToolbar\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 78\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        className: \"btn grey lighten-3 black-text\",\n        onClick: this.handleCancel,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 79\n        },\n        __self: this\n      }, \" Cancelar \"), React.createElement(\"button\", {\n        className: \"btn grey lighten-3 black-text\",\n        onClick: this.handlePay,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 80\n        },\n        __self: this\n      }, \" Pagar \"))))));\n    } //--------------------------------------------------------------------------//\n\n  }]);\n\n  return CartShopPage;\n}(Component);\n\nexport { CartShopPage as default };","map":{"version":3,"sources":["C:\\Users\\LENOVO\\Desktop\\tienda-react\\src\\Views\\CartShopPage.js"],"names":["React","Component","TopBar","db","firebase","CartList","CartShopPage","props","handlePay","history","getProductsInCart","state","user","uid","remove","then","push","handleCancel","item","itemsInCart","map","key","disponible","parseInt","product","cantidad","getProduct","id","update","document","title","total","body","style","backgroundImage","backgroundRepeat","backgroundSize","auth","onAuthStateChanged","authUser","setState","on","snapshot","val","nexProps","nextState","index","precio","toFixed"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport TopBar from './TopBar'\r\nimport { db, firebase } from '../Firebase'\r\nimport CartList from '../Cart/List.js'\r\nimport './mainStyle.css'\r\n\r\nexport default class CartShopPage extends Component {\r\n    constructor(props) {\r\n        super(props)\r\n        document.title = 'Tienda Online'\r\n        this.state = {\r\n            user: null,\r\n            itemsInCart: [],\r\n            total: 0\r\n        }\r\n    }\r\n    //--------------------------------------------------------------------//\r\n    componentWillMount() {\r\n        document.body.style.backgroundImage = \"url('./img/main-fondo.jpg')\";\r\n        document.body.style.backgroundRepeat = \"no-repeat\";\r\n        document.body.style.backgroundSize = \"cover\";\r\n    }\r\n    //--------------------------------------------------------------------//\r\n    componentDidMount() {\r\n        const { history } = this.props;\r\n\r\n        firebase.auth.onAuthStateChanged(authUser => {\r\n            if (authUser) {\r\n                this.setState({ user: authUser })\r\n                db.getProductsInCart(authUser.uid).on('value', snapshot => {\r\n                    if (snapshot.val()) {\r\n                        this.setState({ itemsInCart: snapshot.val() })\r\n                    } else this.setState({ itemsInCart: [] })\r\n                })\r\n            } else history.push('/login')\r\n        })\r\n    }\r\n    //-------------------------------------------------------------------------//\r\n    shouldComponentUpdate(nexProps, nextState) {\r\n        let total = 0\r\n        nextState.itemsInCart.map((item, index) =>\r\n            total += (item.product.precio * item.cantidad)\r\n        )\r\n        nextState.total = total\r\n        return true\r\n    }\r\n    //-------------------------------------------------------------------------//\r\n    handlePay = () => {\r\n        const { history } = this.props\r\n        db.getProductsInCart(this.state.user.uid).remove().then(() => history.push('/'))\r\n    }\r\n    //--------------------------------------------------------------------------//\r\n    handleCancel = () => {\r\n        const { history } = this.props\r\n        const item = this.state.itemsInCart.map((item, key) => item)\r\n        let disponible = parseInt(item[0].product.disponible, 10)\r\n        let cantidad = parseInt(item[0].cantidad, 10)\r\n        item[0].product.disponible = (disponible + cantidad)\r\n        db.getProduct(item[0].id).update(item[0].product)\r\n\r\n        db.getProductsInCart(this.state.user.uid).remove().then(() => history.push('/'))\r\n    }\r\n    //---------------------------------------------------------------------------//\r\n    render() {\r\n        return (\r\n            <div>\r\n                <TopBar itemsInCart={this.state.itemsInCart} />\r\n                <div className='container grey lighten-5'>\r\n                    <div className='row'>\r\n                        <div className='col s8'>\r\n                            <h3> Carrito de compras </h3>\r\n                        </div>\r\n                        <div className='col s7'>\r\n                            <CartList products={this.state.itemsInCart} />\r\n                        </div>\r\n                        <div className='col s5'>\r\n                            <h4> Total: ${(this.state.total).toFixed(2)}</h4>\r\n                            <div className='buttonToolbar'>\r\n                                <button className='btn grey lighten-3 black-text' onClick={this.handleCancel}> Cancelar </button>\r\n                                <button className='btn grey lighten-3 black-text' onClick={this.handlePay}> Pagar </button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n    //--------------------------------------------------------------------------//\r\n}"]},"metadata":{},"sourceType":"module"}