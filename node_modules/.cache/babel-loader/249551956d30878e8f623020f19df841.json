{"ast":null,"code":"import _toConsumableArray from \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\tienda-react\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\tienda-react\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\tienda-react\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\tienda-react\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\tienda-react\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\tienda-react\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\tienda-react\\\\src\\\\Views\\\\MainPage.js\";\nimport React, { Component } from 'react';\nimport TopBar from './TopBar';\nimport ProductSearch from '../Products/Search';\nimport ProductList from '../Products/List';\nimport { db, firebase } from '../Firebase';\nimport './mainStyle.css';\n\nvar MainPage =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(MainPage, _Component);\n\n  function MainPage(props, context) {\n    var _this;\n\n    _classCallCheck(this, MainPage);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(MainPage).call(this, props, context));\n\n    _this.searchProduct = function (input) {\n      return _this.setState({\n        filter: input.target.value\n      });\n    };\n\n    _this.addToCart = function (product, amount) {\n      var id = _this.state.products.indexOf(product);\n\n      var userid = _this.state.user.uid;\n      product.disponible = product.disponible - amount;\n      db.getProduct(id).update(product);\n      db.getProductsInCart(userid).set([].concat(_toConsumableArray(_this.state.itemsInCart), [{\n        id: id,\n        product: product,\n        cantidad: amount\n      }]));\n    };\n\n    document.title = 'Tienda Online';\n    _this.state = {\n      user: null,\n      filter: '',\n      products: [],\n      itemsInCart: []\n    };\n    return _this;\n  } //---------------------------------------------------------------------//\n\n\n  _createClass(MainPage, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      document.body.style.backgroundImage = \"url('./img/main-fondo.jpg')\";\n      document.body.style.backgroundRepeat = \"no-repeat\";\n      document.body.style.backgroundSize = \"cover\";\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var history = this.props.history;\n\n      try {\n        firebase.auth.onAuthStateChanged(function (authUser) {\n          if (authUser) {\n            _this2.setState({\n              user: authUser\n            });\n\n            db.getProductsInCart(authUser.uid).on('value', function (snapshot) {\n              if (snapshot.val()) {\n                _this2.setState({\n                  itemsInCart: snapshot.val()\n                });\n              } else _this2.setState({\n                itemsInCart: []\n              });\n            });\n          } else {\n            console.log('No estas logeado');\n            history.push('/login');\n          }\n        });\n      } catch (error) {\n        alert(error);\n      }\n\n      db.getProducts().on('value', function (snapshot) {\n        _this2.setState({\n          products: snapshot.val()\n        });\n      });\n    } //---------------------- Buscar un Producto ----------------------//\n\n  }, {\n    key: \"render\",\n    //--------------------------------------------------------------------//\n    value: function render() {\n      var products = this.state.products;\n      return React.createElement(\"div\", {\n        className: \"fondoprincipal\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 72\n        },\n        __self: this\n      }, React.createElement(TopBar, {\n        itemsInCart: this.state.itemsInCart,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 73\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"container grey lighten-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 75\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col s8\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 76\n        },\n        __self: this\n      }, React.createElement(\"h3\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77\n        },\n        __self: this\n      }, \"Cat\\xE1logo de Productos\")), React.createElement(\"div\", {\n        className: \"col s4\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 79\n        },\n        __self: this\n      }, React.createElement(ProductSearch, {\n        search: this.searchProduct.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 80\n        },\n        __self: this\n      }))), React.createElement(\"div\", {\n        className: \"row alto\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 83\n        },\n        __self: this\n      }, !!products && React.createElement(ProductList, {\n        products: products,\n        filter: this.state.filter,\n        add: this.addToCart.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84\n        },\n        __self: this\n      }))));\n    }\n  }]);\n\n  return MainPage;\n}(Component); //------------------------------------------------------------------//\n\n\nexport default MainPage;","map":{"version":3,"sources":["C:\\Users\\LENOVO\\Desktop\\tienda-react\\src\\Views\\MainPage.js"],"names":["React","Component","TopBar","ProductSearch","ProductList","db","firebase","MainPage","props","context","searchProduct","input","setState","filter","target","value","addToCart","product","amount","id","state","products","indexOf","userid","user","uid","disponible","getProduct","update","getProductsInCart","set","itemsInCart","cantidad","document","title","body","style","backgroundImage","backgroundRepeat","backgroundSize","history","auth","onAuthStateChanged","authUser","on","snapshot","val","console","log","push","error","alert","getProducts","bind"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport TopBar from './TopBar'\r\nimport ProductSearch from '../Products/Search'\r\nimport ProductList from '../Products/List'\r\n\r\nimport { db, firebase } from '../Firebase'\r\nimport './mainStyle.css'\r\n\r\n\r\n\r\nclass MainPage extends Component {\r\n    constructor(props, context) {\r\n        super(props, context)\r\n        document.title = 'Tienda Online'\r\n        this.state = {\r\n            user: null,\r\n            filter: '',\r\n            products: [],\r\n            itemsInCart: []\r\n        }\r\n    }\r\n    //---------------------------------------------------------------------//\r\n    componentWillMount() {\r\n        document.body.style.backgroundImage = \"url('./img/main-fondo.jpg')\";\r\n        document.body.style.backgroundRepeat = \"no-repeat\";\r\n        document.body.style.backgroundSize = \"cover\";\r\n    }\r\n    componentDidMount() {\r\n        const { history } = this.props\r\n        try {\r\n            firebase.auth.onAuthStateChanged(authUser => {\r\n                if (authUser) {\r\n                    this.setState({ user: authUser })\r\n                    db.getProductsInCart(authUser.uid).on('value', snapshot => {\r\n                        if (snapshot.val()) {\r\n                            this.setState({ itemsInCart: snapshot.val() })\r\n                        } else this.setState({ itemsInCart: [] })   \r\n                    })\r\n                } else {\r\n                    console.log('No estas logeado')\r\n                    history.push('/login')\r\n                }\r\n            })\r\n        } catch (error) { alert(error) }\r\n        db.getProducts().on('value', snapshot => {\r\n            this.setState({ products: snapshot.val() })\r\n        })\r\n    }\r\n    //---------------------- Buscar un Producto ----------------------//\r\n    searchProduct = (input) => this.setState({ filter: input.target.value })\r\n\r\n    //---------------------- Agregar al Carrito ----------------------//\r\n    addToCart = (product, amount) => {\r\n        const id = this.state.products.indexOf(product)\r\n        const userid = this.state.user.uid\r\n        product.disponible = (product.disponible - amount)\r\n        db.getProduct(id).update(product)\r\n        db.getProductsInCart(userid)\r\n            .set([\r\n                ...this.state.itemsInCart,\r\n                {\r\n                    id: id,\r\n                    product: product,\r\n                    cantidad: amount\r\n                }])\r\n    }\r\n\r\n    //--------------------------------------------------------------------//\r\n    render() {\r\n        const { products } = this.state\r\n        return (\r\n            <div className='fondoprincipal'>\r\n                <TopBar itemsInCart={this.state.itemsInCart} />\r\n                <div className='container grey lighten-5'>\r\n                    <div className='row'>\r\n                        <div className='col s8'>\r\n                            <h3>Catálogo de Productos</h3>\r\n                        </div>\r\n                        <div className='col s4'>\r\n                            <ProductSearch search={this.searchProduct.bind(this)} />\r\n                        </div>\r\n                    </div>\r\n                    <div className='row alto'>\r\n                        {!!products && <ProductList products={products}\r\n                            filter={this.state.filter}\r\n                            add={this.addToCart.bind(this)} />}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n        )\r\n    }\r\n}\r\n//------------------------------------------------------------------//\r\n\r\nexport default MainPage"]},"metadata":{},"sourceType":"module"}